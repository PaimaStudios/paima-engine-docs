"use strict";(self.webpackChunkpaima_engine_docs=self.webpackChunkpaima_engine_docs||[]).push([[4430],{9218:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var i=t(5893),s=t(1151);const a={},o="Cardano Primitives",r={id:"home/react-to-events/primitive-catalogue/cardano",title:"Cardano Primitives",description:"- Stake Delegation.",source:"@site/docs/home/300-react-to-events/2-primitive-catalogue/1000-cardano.md",sourceDirName:"home/300-react-to-events/2-primitive-catalogue",slug:"/home/react-to-events/primitive-catalogue/cardano",permalink:"/ja/home/react-to-events/primitive-catalogue/cardano",draft:!1,unlisted:!1,editUrl:"https://github.com/PaimaStudios/paima-engine-docs/docs/home/300-react-to-events/2-primitive-catalogue/1000-cardano.md",tags:[],version:"current",sidebarPosition:1e3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Generic Primitives",permalink:"/ja/home/react-to-events/primitive-catalogue/Generic"},next:{title:"Create your own Primitive",permalink:"/ja/home/react-to-events/primitive-catalogue/create-your-own"}},d={},l=[{value:"Stake Delegation",id:"stake-delegation",level:2},{value:"Example",id:"example",level:3},{value:"Meaning",id:"meaning",level:3},{value:"Paima Concise format",id:"paima-concise-format",level:3},{value:"Utility functions",id:"utility-functions",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"cardano-primitives",children:"Cardano Primitives"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#stake-delegation",children:"Stake Delegation"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"stake-delegation",children:"Stake Delegation"}),"\n",(0,i.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'extensions:\n   - name: "Cardano Stake Delegation"\n     type: cardano-stake-delegation\n     pools:\n       - "00000000000000000000000000000000000000000000000000000001"\n       - "00000000000000000000000000000000000000000000000000000002"\n     startSlot: 32815320\n     stopSlot: 32815924\n     scheduledPrefix: cd\n'})}),"\n",(0,i.jsx)(n.h3,{id:"meaning",children:"Meaning"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"startSlot"})," is required and means that only delegation events after that slot (exclusive) will be considered."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"stopSlot"})," is optional, and it stops the indexing at that point for that pool."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pools"})," is a list of pool credentials to keep track of."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"paima-concise-format",children:"Paima Concise format"}),"\n",(0,i.jsx)(n.p,{children:"The scheduled input for each event is of the following form."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"prefix|address|pool\n"})}),"\n",(0,i.jsx)(n.p,{children:"where:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"prefix"})," is the ",(0,i.jsx)(n.code,{children:"scheduledPrefix"})," specified in the config file,"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"address"})," is the stake credential of the address in CBOR."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pool"})," if the event is a delegation event, this is the pool. If the staking key is deregistered, or delegated to a pool outside the indexed ones, this will be null."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"utility-functions",children:"Utility functions"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"getCardanoAddressDelegation"})," can be used to get the current pool (if any). It\nmust be called with the stake credential of the address. This is the state up to\nthe last delegation transaction associated to this address, but this doesn't\nmean that the there is an epoch boundary between this delegation event an the\ncurrent epoch, so this address may still not be receiving rewards from the pool\nreturned by this function."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"export declare function getCardanoAddressDelegation(\n  readonlyDBConn: Pool,\n  address: string\n): Promise<string | null>;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Example using cml:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const address = Address.from_bech32(addressBech32);\nconst stakingCred = address.staking_cred();\n\nlet credential: Buffer;\n\nif (stakingCred) {\n  credential = Buffer.from(stakingCred.to_bytes());\n}\n\ngetCardanoAddressDelegation(dbConn, walletAddress);\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>o});var i=t(7294);const s={},a=i.createContext(s);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);