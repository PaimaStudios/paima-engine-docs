"use strict";(self.webpackChunkpaima_engine_docs=self.webpackChunkpaima_engine_docs||[]).push([[2180],{3773:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>c,toc:()=>r});var a=t(5893),i=t(1151);const l={},o="Avail block funnel",c={id:"home/state-machine/react-to-events/funnel-types/avail-block-funnel",title:"Avail block funnel",description:"An analogous to the evm block funnel but for Avail.",source:"@site/docs/home/100-state-machine/300-react-to-events/3-funnel-types/800-avail-block-funnel.md",sourceDirName:"home/100-state-machine/300-react-to-events/3-funnel-types",slug:"/home/state-machine/react-to-events/funnel-types/avail-block-funnel",permalink:"/ja/home/state-machine/react-to-events/funnel-types/avail-block-funnel",draft:!1,unlisted:!1,editUrl:"https://github.com/PaimaStudios/paima-engine-docs/tree/main/docs/home/100-state-machine/300-react-to-events/3-funnel-types/800-avail-block-funnel.md",tags:[],version:"current",sidebarPosition:800,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Parallel Avail funnel",permalink:"/ja/home/state-machine/react-to-events/funnel-types/parallel-avail-funnel"},next:{title:"Primitive Catalogue",permalink:"/ja/home/state-machine/react-to-events/primitive-catalogue/introduction"}},s={},r=[{value:"Configuration",id:"configuration",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"avail-block-funnel",children:"Avail block funnel"}),"\n",(0,a.jsxs)(n.p,{children:["An analogous to the ",(0,a.jsx)(n.a,{href:"/ja/home/state-machine/react-to-events/funnel-types/block-funnel",children:"evm block funnel"})," but for Avail."]}),"\n",(0,a.jsx)(n.p,{children:"This funnel will do the following:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Get the latest block number with verified data availability from the Avail light client through the ",(0,a.jsx)(n.code,{children:"v2/status"})," endpoint. ",(0,a.jsx)(n.a,{href:"https://docs.availproject.org/docs/operate-a-node/run-a-light-client/light-client-api-reference#v2status",children:"Reference"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["Fetch a group of ",(0,a.jsx)(n.code,{children:"funnelBlockGroupSize"})," headers (or less if we're already at the tip)."]}),"\n",(0,a.jsxs)(n.li,{children:["Fetch all the submitted data from the Avail light client through the ",(0,a.jsx)(n.code,{children:"v2/blocks/{block_number}/data"})," endpoint (",(0,a.jsx)(n.a,{href:"https://docs.availproject.org/docs/operate-a-node/run-a-light-client/light-client-api-reference#v2blocksblock_numberdatafieldsdataextrinsic",children:"reference"}),"). This means full blocks are never processed, because the light client can filter by app id."]}),"\n",(0,a.jsxs)(n.li,{children:["Use ",(0,a.jsx)(n.code,{children:"TextDecoder"})," to read the binary input as text, and continue with the Paima concise format processing."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"Avail:\n  type: avail-main\n  lightClient: 'http://localhost:7007'\n  rpc: ws://127.0.0.1:9944\n  funnelBlockGroupSize: 100\n  presyncStepSize: 1000\n  genesisHash: \"0xdd60847daa1119ecc9bdd006b140087737ac03d260ce110ecd7cb33cf721be35\"\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>c,a:()=>o});var a=t(7294);const i={},l=a.createContext(i);function o(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);