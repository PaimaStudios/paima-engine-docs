"use strict";(self.webpackChunkpaima_engine_docs=self.webpackChunkpaima_engine_docs||[]).push([[5651],{4050:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var t=i(5893),a=i(1151);const o={sidebar_position:1},r="How To Use Paima Engine",s={id:"home/setup/how-to-use-paima-engine",title:"How To Use Paima Engine",description:"Paima Engine is as an all-in-one batteries-included executable which provides you with everything you need to get started writing your own trustless Web3 game.",source:"@site/docs/home/1-setup/1-how-to-use-paima-engine.md",sourceDirName:"home/1-setup",slug:"/home/setup/how-to-use-paima-engine",permalink:"/home/setup/how-to-use-paima-engine",draft:!1,unlisted:!1,editUrl:"https://github.com/PaimaStudios/paima-engine-docs/docs/home/1-setup/1-how-to-use-paima-engine.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"What is Paima Engine?",permalink:"/"},next:{title:"Environment Configuration Variables",permalink:"/home/setup/environment-config-values"}},l={},d=[{value:"Accessing Documentation",id:"accessing-documentation",level:2},{value:"Accessing Paima Engine",id:"accessing-paima-engine",level:2},{value:"tl;dr",id:"tldr",level:2},{value:"Initializing Your Project",id:"initializing-your-project",level:2},{value:"Packing Your Game Code",id:"packing-your-game-code",level:2},{value:"Setting Up Your Game Node Config",id:"setting-up-your-game-node-config",level:2},{value:"Building your Middleware",id:"building-your-middleware",level:2},{value:"Deploying Your Game&#39;s Contracts",id:"deploying-your-games-contracts",level:2},{value:"Running Your Frontend",id:"running-your-frontend",level:2},{value:"Connecting Metamask to Your Frontend",id:"metamask",level:3},{value:"Option 1:<code>Hardhat Private Key \u2192 MetaMask</code>",id:"option-1hardhat-private-key--metamask",level:4},{value:"Option 2: <code>MetaMask mnemonic \u2192 Hardhat</code>",id:"option-2-metamask-mnemonic--hardhat",level:4},{value:"Setting Up Your Game Node DB",id:"setting-up-your-game-node-db",level:2},{value:"Running Your Game Node",id:"running-your-game-node",level:2},{value:"Testing Out Your Game Node",id:"testing-out-your-game-node",level:2},{value:"Releasing your game",id:"releasing-your-game",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Paima Engine Dry Running",id:"paima-engine-dry-running",level:3}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"how-to-use-paima-engine",children:"How To Use Paima Engine"}),"\n",(0,t.jsx)(n.p,{children:"Paima Engine is as an all-in-one batteries-included executable which provides you with everything you need to get started writing your own trustless Web3 game."}),"\n",(0,t.jsx)(n.h2,{id:"accessing-documentation",children:"Accessing Documentation"}),"\n",(0,t.jsx)(n.p,{children:"Paima Engine docs are available from two sources:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Embedded inside Paima Engine itself (",(0,t.jsx)(n.code,{children:"./paima-engine docs"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Hosted on ",(0,t.jsx)(n.a,{href:"https://docs.paimastudios.com",children:"docs.paimastudios.com"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"accessing-paima-engine",children:"Accessing Paima Engine"}),"\n",(0,t.jsxs)(n.p,{children:["Paima Engine binaries can be found on Github in the ",(0,t.jsx)(n.a,{href:"https://github.com/PaimaStudios/paima-engine/releases",children:"release page"})," of the project."]}),"\n",(0,t.jsxs)(n.p,{children:["If you need any support beyond the core engine, you can reach us through our ",(0,t.jsx)(n.a,{href:"https://paimastudios.com/contact/",children:"contacting us"})," page."]}),"\n",(0,t.jsxs)(n.p,{children:["If you do not have Paima Engine yet, but want to follow along, you can find public templates using Paima ",(0,t.jsx)(n.a,{href:"https://github.com/PaimaStudios/paima-game-templates",children:"here"})]}),"\n",(0,t.jsx)(n.h2,{id:"tldr",children:"tl;dr"}),"\n",(0,t.jsx)(n.p,{children:"If you're running a template and just want to know which commands to run without having to know what they do, simply run the following"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run initialize # setup the env vars and install dependencies\nnpm run pack # build your state machine\nnpm run pack:middleware # create middleware to connect your state machine to your UI\nnpm run chain:start # separate terminal - creates a local L1 chain for your app\nnpm run chain:deploy # deploys contracts to your local chain\nnpm run database:up # separate terminal - starts the DB to cache the onchain data to speed up queries\n./paima-engine run # separate terminal - runs your game L2 node\n# see `frontend` folder in your project for launching the UI for your game\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Next, (if running on a local chain), set hardhat and your browser wallet to use the same private key (see more info ",(0,t.jsx)(n.a,{href:"#metamask",children:"here"}),")."]}),"\n",(0,t.jsx)(n.h2,{id:"initializing-your-project",children:"Initializing Your Project"}),"\n",(0,t.jsx)(n.p,{children:"When starting a new project with Paima Engine, you can choose to either go completely barebones, or use an included template to bootstrap with all of the essentials"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Option A"}),": To initialize a game using a basic game template, either clone git repo ",(0,t.jsx)(n.a,{href:"https://github.com/PaimaStudios/paima-game-templates",children:"here"})," or use the following command and select the ",(0,t.jsx)(n.code,{children:"rock-paper-scissors"})," template:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"./paima-engine init template\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Option B"}),": Create everything from scratch. Although you can find all the Paima Engine packages to do this (ex: ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/@paima/sdk",children:"@paima/sdk"}),"), we strongly recommend starting from a template."]}),"\n",(0,t.jsxs)(n.p,{children:["Once the command has finished, you will notice a new folder have been created called ",(0,t.jsx)(n.code,{children:"rock-paper-scissors"})," (name varies based on template selected). The SDK is directly used by the game template, and so all code you write will be in the ",(0,t.jsx)(n.code,{children:"rock-paper-scissors"})," folder."]}),"\n",(0,t.jsxs)(n.p,{children:["Lastly to finish the initialization process off, simply go into the ",(0,t.jsx)(n.code,{children:"rock-paper-scissors"})," folder and run ",(0,t.jsx)(n.code,{children:"npm run initialize"}),". This will install all of the packages and set the project up to be ready for you to start coding."]}),"\n",(0,t.jsxs)(n.p,{children:["Of note, feel free to rename the ",(0,t.jsx)(n.code,{children:"rock-paper-scissors"})," folder to the name of your game (or whatever you prefer)"]}),"\n",(0,t.jsx)(n.h2,{id:"packing-your-game-code",children:"Packing Your Game Code"}),"\n",(0,t.jsx)(n.p,{children:"The specifics of writing your game code is outside of the scope of this current getting started guide, thus we will move on to packing your game code to be run with Paima Engine."}),"\n",(0,t.jsxs)(n.p,{children:["As the ",(0,t.jsx)(n.code,{children:"rock-paper-scissors"})," folder has already been initialized in the previous section, we can move forward with packing the game code (you can pack the rock-paper-scissors game template without writing any new code initially to test). Simply use the following command in the folder:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run pack\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This will generate two files (",(0,t.jsx)(n.code,{children:"gameCode.cjs"})," and ",(0,t.jsx)(n.code,{children:"endpoints.cjs"}),") which will be placed in a ",(0,t.jsx)(n.code,{children:"packaged"}),' folder (located next to the executable). The former file holds the vast majority of the "game" (all of your code related to your game logic and state transitions) and the latter holds code related to setting up the webserver endpoints of your game node.']}),"\n",(0,t.jsxs)(n.p,{children:["Both of these files need to remain in the ",(0,t.jsx)(n.code,{children:"packaged"})," folder (which is required to be in the same root folder as the Paima Engine executable itself)."]}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-your-game-node-config",children:"Setting Up Your Game Node Config"}),"\n",(0,t.jsxs)(n.p,{children:["You may have noticed that during the initialization process a ",(0,t.jsx)(n.code,{children:".env.localhost"})," file was created in the root folder. The Paima Engine executable will read this file (or specifically ",(0,t.jsx)(n.code,{children:".env.${process.env.NETWORK || localhost})"}),") when attempting to start running your game node."]}),"\n",(0,t.jsxs)(n.p,{children:["Thus you must fill out this env file with all of the pre-requisites to proceed forward (see how ",(0,t.jsx)(n.a,{href:"/home/setup/environment-config-values",children:"here"}),")."]}),"\n",(0,t.jsx)(n.h2,{id:"building-your-middleware",children:"Building your Middleware"}),"\n",(0,t.jsx)(n.p,{children:"The Paima middleware provides a framework-independent way of writing code for the frontend to consume. This is useful to:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Provide a minimal interface for frontends that cannot natively run Javascript (and therefore cannot use anything in ",(0,t.jsx)(n.code,{children:"@paima/sdk"})," directly) like Unity"]}),"\n",(0,t.jsxs)(n.li,{children:["Provide a framework-independent way of performing calculations whose result need to be available at compile time from your frontend (using ",(0,t.jsx)(n.a,{href:"https://github.com/esbuild/community-plugins",children:"esbuild"}),") like reading node configuration files."]}),"\n",(0,t.jsx)(n.li,{children:"Allow sharing parts of your node code to your frontend (or other systems)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"If you need this for the template you are building, run"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run pack:middleware\n"})}),"\n",(0,t.jsx)(n.h2,{id:"deploying-your-games-contracts",children:"Deploying Your Game's Contracts"}),"\n",(0,t.jsx)(n.p,{children:"Each game built with Paima Engine is its very own Layer 2. This means that you will need to deploy the Paima L2 Smart Contract for your game, to whichever chain you wish to launch on on top of any other contract necessary for your app."}),"\n",(0,t.jsx)(n.p,{children:"For templates, this usually involves simply running:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"npm run chain:start"})," to start a chain on the local network"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"npm run chain:deploy"})," to deploy contracts to the local network (see ",(0,t.jsx)(n.code,{children:"hardhat.config.ts"})," for network names)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"If you are running the local network, you should see an output that starts like this"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"WARNING: These accounts, and their private keys, are publicly known.\nAny funds sent to them on Mainnet or any other live network WILL BE LOST.\n\nAccount #0: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000 ETH)\nPrivate Key: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Keep ",(0,t.jsx)(n.code,{children:"Private Key"})," in mind here, because you will need to include this in MetaMask (or your browser extension of choice) later for interacting with your local game node."]}),"\n",(0,t.jsxs)(n.p,{children:["Reference the ",(0,t.jsx)(n.a,{href:"/home/smart-contracts/evm/introduction",children:"Deploying L2 Smart Contract"})," documentation to learn more."]}),"\n",(0,t.jsx)(n.h2,{id:"running-your-frontend",children:"Running Your Frontend"}),"\n",(0,t.jsxs)(n.p,{children:["Depending on which template you are using, there may be a ",(0,t.jsx)(n.code,{children:"frontend"})," folder. Run the framework-specific steps in that folder to start your game's frontend"]}),"\n",(0,t.jsx)(n.h3,{id:"metamask",children:"Connecting Metamask to Your Frontend"}),"\n",(0,t.jsx)(n.p,{children:"Key points to keep in mind:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["These steps are ",(0,t.jsx)(n.strong,{children:"only required if running on a localhost network"})," (not required on mainnet / testnet)"]}),"\n",(0,t.jsxs)(n.li,{children:["You will need to reset your nonce often for this by going to ",(0,t.jsx)(n.code,{children:"Settings > Advanced > Clear activity and nonce data"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"There are two ways to connect MetaMask to your local network"}),"\n",(0,t.jsxs)(n.h4,{id:"option-1hardhat-private-key--metamask",children:["Option 1:",(0,t.jsx)(n.code,{children:"Hardhat Private Key \u2192 MetaMask"})]}),"\n",(0,t.jsxs)(n.p,{children:["If you're using ",(0,t.jsx)(n.a,{href:"https://metamask.io/",children:"MetaMask"}),", you can interact with your contract from your frontend with these steps:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Open the MetaMask extension"}),"\n",(0,t.jsx)(n.li,{children:"Click on the account selector at the top of the screen"}),"\n",(0,t.jsx)(n.li,{children:'Click "add account"'}),"\n",(0,t.jsx)(n.li,{children:'Select "import account"'}),"\n",(0,t.jsxs)(n.li,{children:["Paste in the private key seen when running ",(0,t.jsx)(n.code,{children:"npm run chain:deploy"})]}),"\n"]}),"\n",(0,t.jsxs)(n.h4,{id:"option-2-metamask-mnemonic--hardhat",children:["Option 2: ",(0,t.jsx)(n.code,{children:"MetaMask mnemonic \u2192 Hardhat"})]}),"\n",(0,t.jsxs)(n.p,{children:["See the Metamask guide for this ",(0,t.jsx)(n.a,{href:"https://docs.metamask.io/wallet/how-to/get-started-building/run-devnet/",children:"here"})]}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-your-game-node-db",children:"Setting Up Your Game Node DB"}),"\n",(0,t.jsx)(n.p,{children:"If you're using a template, all you need to do is:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Have ",(0,t.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"Docker"})," installed on your machine"]}),"\n",(0,t.jsxs)(n.li,{children:["Run (in a separate terminal instance) ",(0,t.jsx)(n.code,{children:"npm run database:up"})]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"ctrl + c"})," to close the database at any time"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To learn how to edit your app's database, read more about database management ",(0,t.jsx)(n.a,{href:"/home/database-management/setup",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"running-your-game-node",children:"Running Your Game Node"}),"\n",(0,t.jsx)(n.p,{children:"Now that your game code is packed, contract and DB deployed, and your config is ready, we can now start your game node via the Paima Engine executable."}),"\n",(0,t.jsx)(n.p,{children:"Simply go into the root folder and run the following command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"./paima-engine run\n"})}),"\n",(0,t.jsx)(n.p,{children:"If you forgot to pack your code, your config is not properly setup, or anything else as such, you will get an error."}),"\n",(0,t.jsx)(n.p,{children:"Otherwise if everything was setup correctly then you will have officially started your game node for the very first time! You will see some initial boot logs, and after a few seconds see the progress of your game node syncing from the blockchain."}),"\n",(0,t.jsxs)(n.p,{children:["These logs denote the block height numbers that the game node is syncing from the deployed L2 smart contract on the blockchain. Other logs will also pop up, such as when game inputs are read from the contract. Of note, logs are also saved in the ",(0,t.jsx)(n.code,{children:"logs.log"})," file for easy access."]}),"\n",(0,t.jsx)(n.h2,{id:"testing-out-your-game-node",children:"Testing Out Your Game Node"}),"\n",(0,t.jsx)(n.p,{children:"Now that your game node is syncing, we recommend testing to ensure that both the contract you deployed and the node itself are all in working order/configured properly."}),"\n",(0,t.jsxs)(n.p,{children:["Simply follow the ",(0,t.jsx)(n.a,{href:"/home/read-write-L2-state/write-data#writing-data-from-an-external-source",children:"posting test game inputs to L2 contract tutorial"})," and within a couple minutes you'll have experienced the end-to-end loop of using Paima Engine!"]}),"\n",(0,t.jsx)(n.p,{children:"Of note, the above tutorial teaches you an easy way to manually submit custom-crafted game inputs, which is also useful when implementing new features as you develop your games/apps."}),"\n",(0,t.jsx)(n.h2,{id:"releasing-your-game",children:"Releasing your game"}),"\n",(0,t.jsxs)(n.p,{children:["You can learn more about the steps to releasing your game publicly ",(0,t.jsx)(n.a,{href:"/home/releasing-a-game/generate-build",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,t.jsx)(n.h3,{id:"paima-engine-dry-running",children:"Paima Engine Dry Running"}),"\n",(0,t.jsxs)(n.p,{children:["For context, ",(0,t.jsx)(n.a,{href:"/home/setup/paima-bacher",children:"Paima Batcher"})," allows end users to sign game inputs without manually posting transactions themselves. It enables the cross-chain Paima Whirlpool functionality to be possible in Paima Engine."]}),"\n",(0,t.jsx)(n.p,{children:'For Paima Batcher to work well in production, game inputs can be validated before posting on-chain to save on transaction fees & increase throughput. To support this validation Paima Engine ships with a "dry run" endpoint which allows directly submitting a game input via HTTP, and having it processed by the STF (returning success or fail) without saving any of the resulting SQL queries. As such this allows the batcher (or any external tooling) to check that a game input validates before posting it on-chain.'}),"\n",(0,t.jsx)(n.p,{children:"This functionality is disabled by default to ensure that in production any game nodes which are user-facing have dry running disabled (as this is a DoS vector)."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["You can enable dry running by setting the environment variable in your .env file: ",(0,t.jsx)(n.code,{children:"ENABLE_DRY_RUN=true"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Once enabled, your game node will now have a ",(0,t.jsx)(n.code,{children:"/dry_run"})," endpoint which takes params of: ",(0,t.jsx)(n.code,{children:"{gameInput: string, userAddress: string}"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["It is possible to detect dry run game inputs in your game logic (if you want to do advanced testing using dry running) by reading the ",(0,t.jsx)(n.code,{children:"dry_run"})," field in the game input you receive in your STF"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>s,a:()=>r});var t=i(7294);const a={},o=t.createContext(a);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);