"use strict";(self.webpackChunkpaima_engine_docs=self.webpackChunkpaima_engine_docs||[]).push([[2322],{4271:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var o=n(5893),t=n(1151);const i={},a="Error Handling",s={id:"home/state-machine/direct-write/error-handling",title:"Error Handling",description:"Errors are unavoidable. Notably, be sure to take into accounts the following error types:",source:"@site/docs/home/100-state-machine/200-direct-write/300-error-handling.md",sourceDirName:"home/100-state-machine/200-direct-write",slug:"/home/state-machine/direct-write/error-handling",permalink:"/home/state-machine/direct-write/error-handling",draft:!1,unlisted:!1,editUrl:"https://github.com/PaimaStudios/paima-engine-docs/tree/main/docs/home/100-state-machine/200-direct-write/300-error-handling.md",tags:[],version:"current",sidebarPosition:300,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Writing L2 Data",permalink:"/home/state-machine/direct-write/write-data"},next:{title:"Batched mode",permalink:"/home/state-machine/direct-write/batched-mode"}},d={},c=[];function l(e){const r={code:"code",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.h1,{id:"error-handling",children:"Error Handling"}),"\n",(0,o.jsx)(r.p,{children:"Errors are unavoidable. Notably, be sure to take into accounts the following error types:"}),"\n",(0,o.jsxs)(r.ol,{children:["\n",(0,o.jsx)(r.li,{children:"Programming mistakes"}),"\n",(0,o.jsx)(r.li,{children:"Concurrency issues. Blockchains are asynchronous and so an action that was valid when the user took it may no longer be valid when it appears on-chain. For example, a user could try joining a lobby that no longer exists."}),"\n",(0,o.jsx)(r.li,{children:"User abuse. Just because your application has no UI for something, it doesn't stop somebody from creating a transaction and submitting it to the blockchain manually. For example, a user could try joining the same lobby two times on the same wallet to see if it breaks your application"}),"\n"]}),"\n",(0,o.jsx)(r.p,{children:"To handle errors, Paima has a system to allow define error codes for your application that extend the built-in error handling in Paima"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"import type { ErrorMessageFxn } from '@paima/sdk/utils';\nimport { buildErrorCodeTranslator } from '@paima/sdk/utils';\nimport type { EndpointErrorFxn } from '@paima/sdk/mw-core';\nimport {\n  PaimaMiddlewareErrorCode,\n  PAIMA_MIDDLEWARE_ERROR_MESSAGES,\n  buildAbstractEndpointErrorFxn,\n} from '@paima/sdk/mw-core';\n\nexport const enum MiddlewareErrorCode {\n  // start your error codes after the reserved namespace for Paima Engine's internal system\n  GENERIC_ERROR = PaimaMiddlewareErrorCode.FINAL_PAIMA_GENERIC_ERROR + 1,\n  CANNOT_JOIN_OWN_LOBBY,\n}\n\ntype ErrorMessageMapping = Record<MiddlewareErrorCode, string>;\nconst MIDDLEWARE_ERROR_MESSAGES: ErrorMessageMapping = {\n  [MiddlewareErrorCode.GENERIC_ERROR]: 'Unspecified generic Game error',\n  [MiddlewareErrorCode.CANNOT_JOIN_OWN_LOBBY]: 'Cannot join your own lobby',\n};\n\nconst errorMessageFxn: ErrorMessageFxn = buildErrorCodeTranslator({\n  ...PAIMA_MIDDLEWARE_ERROR_MESSAGES,\n  ...MIDDLEWARE_ERROR_MESSAGES,\n});\n\nexport function buildEndpointErrorFxn(endpointName: string): EndpointErrorFxn {\n  return buildAbstractEndpointErrorFxn(errorMessageFxn, endpointName);\n}\n"})}),"\n",(0,o.jsx)(r.p,{children:"Now, when you need to throw an error, you can easily handle them as seen below"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"const errorFxn = buildEndpointErrorFxn('joinLobby');\n\nif (userJoinedOwnLobby(lobby, userId)) {\n    return errorFxn(MiddlewareErrorCode.CANNOT_JOIN_OWN_LOBBY);\n}\n"})})]})}function m(e={}){const{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},1151:(e,r,n)=>{n.d(r,{Z:()=>s,a:()=>a});var o=n(7294);const t={},i=o.createContext(t);function a(e){const r=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(i.Provider,{value:r},e.children)}}}]);