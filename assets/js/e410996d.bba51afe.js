"use strict";(self.webpackChunkpaima_engine_docs=self.webpackChunkpaima_engine_docs||[]).push([[574],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>u});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),c=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},m=function(e){var n=c(e.components);return a.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),p=c(t),u=r,h=p["".concat(l,".").concat(u)]||p[u]||d[u]||o;return t?a.createElement(h,i(i({ref:n},m),{},{components:t})):a.createElement(h,i({ref:n},m))}));function u(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=p;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},3772:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=t(7462),r=(t(7294),t(3905));const o={},i="Randomness",s={unversionedId:"home/Randomness/index",id:"home/Randomness/index",title:"Randomness",description:"Randomness is an important part of many games and having a good source of randomness prevents users from abusing statistical trends to their own benefit.",source:"@site/docs/home/5 - Randomness/index.md",sourceDirName:"home/5 - Randomness",slug:"/home/Randomness/",permalink:"/home/Randomness/",draft:!1,editUrl:"https://github.com/PaimaStudios/paima-engine-docs/docs/home/5 - Randomness/index.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Stable Tick Rate",permalink:"/home/Reacting to Events/Funnel Types/Stable Tick Funnel"}},l={},c=[{value:"Seed generation for a given block",id:"seed-generation-for-a-given-block",level:2},{value:"Example prando usage",id:"example-prando-usage",level:2}],m={toc:c};function d(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"randomness"},"Randomness"),(0,r.kt)("p",null,"Randomness is an important part of many games and having a good source of randomness prevents users from abusing statistical trends to their own benefit."),(0,r.kt)("p",null,"In our case, we are building Paima Engine to produce games as globally accessible state machines. This means they are inherently deterministic (as everyone has to replay all submitted game input to arrive at the same global state). There is no central server which we rely on who could be the trusted randomness producing source (aka. randomness oracle)."),(0,r.kt)("p",null,"Thus as we move forward having a good source of randomness becomes more and more important."),(0,r.kt)("p",null,"Of note, whenever a new block is generated there are a few pieces of information provided to Paima Engine which have a degree of uncertainty/randomness to them which make them harder to predict:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The block hash"),(0,r.kt)("li",{parentName:"ul"},"The list of submitted data (user game input) which was posted by users to the on-chain smart contract"),(0,r.kt)("li",{parentName:"ul"},"Information about the block producer (randomness coming from the public key they committed to when they became a block producer)")),(0,r.kt)("p",null,"As such, these are the pieces of data which we can start to build randomness from."),(0,r.kt)("p",null,"Paima works by annotating every block with a ",(0,r.kt)("inlineCode",{parentName:"p"},"seed"),". This seed can then be combined with a utility class called ",(0,r.kt)("inlineCode",{parentName:"p"},"Prando")," for most of the common randomness requirements"),(0,r.kt)("h2",{id:"seed-generation-for-a-given-block"},"Seed generation for a given block"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Get the most recent 25 random seeds from previous blocks"),(0,r.kt)("li",{parentName:"ol"},"Calculate ",(0,r.kt)("inlineCode",{parentName:"li"},"interimSeed = base64(sha256([latestBlockHash, ...blockSeeds].join(',')))")),(0,r.kt)("li",{parentName:"ol"},"Use ",(0,r.kt)("inlineCode",{parentName:"li"},"interimSeed")," to randomly add in bits of the block like user addresses, nonces and submitted data during that block"),(0,r.kt)("li",{parentName:"ol"},"Return ",(0,r.kt)("inlineCode",{parentName:"li"},"base64(sha256([...selectedChainData, latestChainData.blockHash, ...blockSeeds].join(',')))"))),(0,r.kt)("p",null,"The goal of this algorithm including bits of ",(0,r.kt)("inlineCode",{parentName:"p"},"ChainData")," for the block is because Paima may have multiple ",(0,r.kt)("a",{parentName:"p",href:"/home/Reacting%20to%20Events/Funnel%20Types/Intro"},"funnels")," that aggregate data from multiple locations and so this would ensure some parts of every funnel get included in the randomness generation. However, most likely we'll improve this seed generation process in the future."),(0,r.kt)("h2",{id:"example-prando-usage"},"Example prando usage"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import Prando from '@paima/prando';\n\nconst prando = new Prando(block.seed);\nconst diceRoll = prando.nextInt(1, 6);\n")))}d.isMDXComponent=!0}}]);